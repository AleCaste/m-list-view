{"version":3,"sources":["webpack:///./examples/pullToRefresh.js","webpack:///./~/rmc-pull-to-refresh/es/PullToRefresh.js","webpack:///./~/rmc-pull-to-refresh/es/index.js"],"names":["NUM_ROWS","genData","pIndex","dataArr","i","push","Demo","props","dataSource","ListView","DataSource","rowHasChanged","row1","row2","state","useBodyScroll","refreshing","down","document","body","style","overflowY","navigator","userAgent","match","setTimeout","lv","scrollTo","setState","cloneWithRows","display","marginBottom","border","marginLeft","el","height","padding","rowData","__html","React","Component","ReactDOM","render","getElementById"],"mappings":"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A0EzB,iDAAAC,CAASC,MAAT,CAAgB,4DAAC,IAAD,OAAhB,EAA0BxB,SAASyB,cAAT,CAAwB,iBAAxB,CAA1B,E;;;;;;;;;;;;;;;;;;;;;;AC5FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,yHAAyH,cAAc;AAC5I;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;;AAEjB;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,oBAAoB;AACxD,iBAAiB;AACjB;AACA,oCAAoC,mBAAmB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,gCAAgC,mBAAmB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,uBAAuB;AAC/D;AACA,iBAAiB;AACjB;AACA;AACA,wCAAwC,qBAAqB;AAC7D;AACA;AACA;AACA;AACA;AACA,4BAA4B,oBAAoB;AAChD;AACA,gCAAgC,oBAAoB;AACpD;AACA;AACA;AACA,wCAAwC,mBAAmB;AAC3D;AACA;AACA,iBAAiB;AACjB;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,4CAA4C;AACjE;AACA;AACA,yBAAyB;AACzB;AACA,6BAA6B,EAAE;AAC/B;AACA;AACA;AACA,6BAA6B,sCAAsC;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uFAA0B;AAC1B;AACA,qBAAqB,oHAA4E;AACjG;AACA;AACA;AACA,KAAK;;AAEL;AACA,CAAC;;AAED;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;;;;;;;;;AC9OA;AACA,0H","file":"examples/pullToRefresh.js","sourcesContent":["/* eslint-disable no-console */\n/* eslint react/sort-comp: 0 */\nimport '../assets/index.less';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport ListView from '../src';\nimport PullToRefresh from 'rmc-pull-to-refresh';\n\nconst NUM_ROWS = 6;\n\nfunction genData(pIndex = 0) {\n  const dataArr = [];\n  for (let i = 0; i < NUM_ROWS; i++) {\n    dataArr.push(`row - ${(pIndex * NUM_ROWS) + i}`);\n  }\n  return dataArr;\n}\n\nclass Demo extends React.Component {\n  constructor(props) {\n    super(props);\n    const dataSource = new ListView.DataSource({\n      rowHasChanged: (row1, row2) => row1 !== row2,\n    });\n\n    this.state = {\n      dataSource,\n      useBodyScroll: false,\n      refreshing: false,\n      down: false,\n    };\n  }\n\n  componentDidMount() {\n    document.body.style.overflowY =\n      navigator.userAgent.match(/Android|iPhone|iPad|iPod/i) ? 'hidden' : 'auto';\n    // you can scroll to the specified position\n    setTimeout(() => this.lv.scrollTo(0, 50), 800);\n\n    // simulate initial Ajax\n    setTimeout(() => {\n      this.setState({\n        dataSource: this.state.dataSource.cloneWithRows(genData()),\n      });\n    }, 600);\n  }\n\n  render() {\n    return (<div>\n      <button\n        style={{ display: 'inline-block', marginBottom: 30, border: 1 }}\n        onClick={() => this.setState({ useBodyScroll: !this.state.useBodyScroll })}\n      >\n        useBodyScroll: {this.state.useBodyScroll ? 'true' : 'false'}\n      </button>\n      <button\n        style={{ display: 'inline-block', marginBottom: 30, marginLeft: 10, border: 1 }}\n        onClick={() => this.setState({ down: !this.state.down })}\n      >\n        direction: {this.state.down ? 'down' : 'up'}\n      </button>\n      <ListView\n        key={this.state.useBodyScroll ? 1 : 0}\n        ref={el => this.lv = el}\n        dataSource={this.state.dataSource}\n        useBodyScroll={this.state.useBodyScroll}\n        style={!this.state.useBodyScroll ? { height: 200, border: '1px solid gray' } : {}}\n        renderHeader={() => <span style={{ padding: 10 }}>header</span>}\n        renderRow={rowData => <div style={{ padding: 16 }}>{rowData}</div>}\n        pullToRefresh={\n          <PullToRefresh\n            className=\"forTest\"\n            direction={this.state.down ? 'down' : 'up'}\n            refreshing={this.state.refreshing}\n            onRefresh={() => {\n              this.setState({ refreshing: true });\n              setTimeout(() => {\n                this.setState({ refreshing: false });\n              }, 1000);\n            }}\n          />\n        }\n      />\n      <div dangerouslySetInnerHTML={{\n        __html: navigator.userAgent.match(/Android|iPhone|iPad|iPod/i) ?\n          '<style>#qrcode, .highlight{ display: none }</style>' : '',\n      }}\n      />\n    </div>);\n  }\n}\n\nReactDOM.render(<Demo />, document.getElementById('__react-content'));\n\n\n\n// WEBPACK FOOTER //\n// ./examples/pullToRefresh.js","import _extends from 'babel-runtime/helpers/extends';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nvar __rest = this && this.__rest || function (s, e) {\n    var t = {};\n    for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n    }if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n        if (e.indexOf(p[i]) < 0) t[p[i]] = s[p[i]];\n    }return t;\n};\nimport React from 'react';\nimport classNames from 'classnames';\nfunction setTransform(nodeStyle, value) {\n    nodeStyle.transform = value;\n    nodeStyle.webkitTransform = value;\n    nodeStyle.MozTransform = value;\n}\nvar DOWN = 'down';\nvar UP = 'up';\nvar INDICATOR = { activate: 'release', deactivate: 'pull', release: 'loading', finish: 'finish' };\n\nvar PullToRefresh = function (_React$Component) {\n    _inherits(PullToRefresh, _React$Component);\n\n    function PullToRefresh() {\n        _classCallCheck(this, PullToRefresh);\n\n        // https://github.com/yiminghe/zscroller/blob/2d97973287135745818a0537712235a39a6a62a1/src/Scroller.js#L355\n        // currSt: `activate` / `deactivate` / `release` / `finish`\n        var _this = _possibleConstructorReturn(this, (PullToRefresh.__proto__ || Object.getPrototypeOf(PullToRefresh)).apply(this, arguments));\n\n        _this.state = {\n            currSt: '',\n            dragOnEdge: false\n        };\n        _this.triggerPullToRefresh = function () {\n            // 在初始化时、用代码 自动 触发 pullToRefresh\n            // 注意：当 direction 为 up 时，当 visible length < content length 时、则看不到效果\n            if (!_this.state.dragOnEdge) {\n                if (_this.props.refreshing) {\n                    if (_this.props.direction === UP) {\n                        _this._lastScreenY = -_this.props.distanceToRefresh - 1;\n                    }\n                    if (_this.props.direction === DOWN) {\n                        _this._lastScreenY = _this.props.distanceToRefresh + 1;\n                    }\n                    setTransform(_this.contentRef.style, 'translate3d(0px,' + _this._lastScreenY + 'px,0)');\n                    _this.setState({ currSt: 'release' });\n                } else {\n                    _this.reset();\n                    _this.setState({ currSt: 'finish' });\n                }\n            }\n        };\n        _this.initPullUp = function (ele) {\n            _this._to = {\n                touchstart: _this.onTouchStart.bind(_this, ele),\n                touchmove: _this.onTouchMove.bind(_this, ele),\n                touchend: _this.onTouchEnd.bind(_this, ele),\n                touchcancel: _this.onTouchEnd.bind(_this, ele)\n            };\n            Object.keys(_this._to).forEach(function (key) {\n                ele.addEventListener(key, _this._to[key]);\n            });\n        };\n        _this.destroyPullUp = function (ele) {\n            Object.keys(_this._to).forEach(function (key) {\n                ele.removeEventListener(key, _this._to[key]);\n            });\n        };\n        _this.onTouchStart = function (_ele, e) {\n            _this._ScreenY = _this._startScreenY = e.touches[0].screenY;\n            // 一开始 refreshing 为 true 时 this._lastScreenY 有值\n            _this._lastScreenY = _this._lastScreenY || 0;\n        };\n        _this.isEdge = function (ele, direction) {\n            var container = _this.props.getScrollContainer();\n            if (container && container === document.body) {\n                // In chrome61 `document.body.scrollTop` is invalid\n                var scrollNode = document.scrollingElement ? document.scrollingElement : document.body;\n                if (direction === UP) {\n                    return scrollNode.scrollHeight - scrollNode.scrollTop <= window.innerHeight;\n                }\n                if (direction === DOWN) {\n                    return scrollNode.scrollTop <= 0;\n                }\n            }\n            if (direction === UP) {\n                return ele.scrollHeight - ele.scrollTop === ele.clientHeight;\n            }\n            if (direction === DOWN) {\n                return ele.scrollTop <= 0;\n            }\n        };\n        _this.onTouchMove = function (ele, e) {\n            // 使用 pageY 对比有问题\n            var _screenY = e.touches[0].screenY;\n            var direction = _this.props.direction;\n            // 拖动方向不符合的不处理\n\n            if (direction === UP && _this._startScreenY < _screenY || direction === DOWN && _this._startScreenY > _screenY) {\n                return;\n            }\n            if (_this.isEdge(ele, direction)) {\n                _this.setState({ dragOnEdge: true });\n                var _diff = Math.round(_screenY - _this._ScreenY);\n                _this._ScreenY = _screenY;\n                _this._lastScreenY += _diff;\n                setTransform(_this.contentRef.style, 'translate3d(0px,' + _this._lastScreenY + 'px,0)');\n                if (Math.abs(_this._lastScreenY) < _this.props.distanceToRefresh) {\n                    if (_this.state.currSt !== 'deactivate') {\n                        // console.log('back to the distance');\n                        _this.setState({ currSt: 'deactivate' });\n                    }\n                } else {\n                    if (_this.state.currSt === 'deactivate') {\n                        // console.log('reach to the distance');\n                        _this.setState({ currSt: 'activate' });\n                    }\n                }\n            }\n        };\n        _this.onTouchEnd = function () {\n            _this.setState({ dragOnEdge: false });\n            if (_this.state.currSt === 'activate') {\n                _this.setState({ currSt: 'release' });\n                _this._timer = setTimeout(function () {\n                    if (!_this.props.refreshing) {\n                        _this.reset();\n                        _this.setState({ currSt: 'finish' });\n                    }\n                    _this._timer = undefined;\n                }, 1000);\n                _this.props.onRefresh();\n            } else {\n                _this.reset();\n            }\n        };\n        _this.reset = function () {\n            _this._lastScreenY = 0;\n            setTimeout(() => setTransform(_this.contentRef.style, 'translate3d(0px,0px,0)'))\n        };\n        return _this;\n    }\n\n    _createClass(PullToRefresh, [{\n        key: 'componentDidUpdate',\n        value: function componentDidUpdate(prevProps) {\n            if (prevProps === this.props) {\n                return;\n            }\n            // triggerPullToRefresh\n            this.triggerPullToRefresh();\n        }\n    }, {\n        key: 'componentDidMount',\n        value: function componentDidMount() {\n            var _this2 = this;\n\n            // `getScrollContainer` most likely return React.Node at the next tick. Need setTimeout\n            setTimeout(function () {\n                _this2.initPullUp(_this2.props.getScrollContainer() || _this2.containerRef);\n                _this2.triggerPullToRefresh();\n            });\n        }\n    }, {\n        key: 'componentWillUnmount',\n        value: function componentWillUnmount() {\n            // Should have no setTimeout here!\n            // setTimeout(function () {\n            this.destroyPullUp(this.props.getScrollContainer() || this.containerRef);\n          // });\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            var _this3 = this;\n\n            var _a = this.props,\n                className = _a.className,\n                prefixCls = _a.prefixCls,\n                children = _a.children,\n                getScrollContainer = _a.getScrollContainer,\n                direction = _a.direction,\n                onRefresh = _a.onRefresh,\n                refreshing = _a.refreshing,\n                indicator = _a.indicator,\n                distanceToRefresh = _a.distanceToRefresh,\n                restProps = __rest(_a, [\"className\", \"prefixCls\", \"children\", \"getScrollContainer\", \"direction\", \"onRefresh\", \"refreshing\", \"indicator\", \"distanceToRefresh\"]);\n            var renderRefresh = function renderRefresh(cls) {\n                var cla = classNames(cls, !_this3.state.dragOnEdge && prefixCls + '-transition');\n                return React.createElement(\n                    'div',\n                    { className: prefixCls + '-content-wrapper' },\n                    React.createElement(\n                        'div',\n                        { className: cla, ref: function ref(el) {\n                                return _this3.contentRef = el;\n                            } },\n                        direction === UP ? children : null,\n                        React.createElement(\n                            'div',\n                            { className: prefixCls + '-indicator' },\n                            indicator[_this3.state.currSt] || INDICATOR[_this3.state.currSt]\n                        ),\n                        direction === DOWN ? children : null\n                    )\n                );\n            };\n            if (getScrollContainer()) {\n                return renderRefresh(prefixCls + '-content ' + prefixCls + '-' + direction);\n            }\n            return React.createElement(\n                'div',\n                _extends({ ref: function ref(el) {\n                        return _this3.containerRef = el;\n                    }, className: classNames(className, prefixCls, prefixCls + '-' + direction) }, restProps),\n                renderRefresh(prefixCls + '-content')\n            );\n        }\n    }]);\n\n    return PullToRefresh;\n}(React.Component);\n\nexport default PullToRefresh;\n\nPullToRefresh.defaultProps = {\n    prefixCls: 'rmc-pull-to-refresh',\n    getScrollContainer: function getScrollContainer() {\n        return undefined;\n    },\n    direction: DOWN,\n    distanceToRefresh: 25,\n    indicator: INDICATOR\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/rmc-pull-to-refresh/es/PullToRefresh.js\n// module id = 312\n// module chunks = 5","import PullToRefresh from './PullToRefresh';\nexport default PullToRefresh;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/rmc-pull-to-refresh/es/index.js\n// module id = 313\n// module chunks = 5"],"sourceRoot":""}